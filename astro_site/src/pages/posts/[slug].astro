---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

interface Props {
  post: CollectionEntry<'posts'>;
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
  <article class="h-entry single">
    <div> 
      <header>
        <h1 class="p-name">
          {post.data.title}
        </h1>
        <small>
          <span>Published by </span>
          <a class="p-author h-card" href="gregmakes.xyz">
            Greg
          </a>
          <span> on </span>
          <time 
            datetime={post.data.date.toISOString()}
            class="dt-published"
          >
            {post.data.date.toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'short', 
              day: 'numeric'
            })}
          </time>
        </small>
      </header>
      <main>
        <div class="e-content">
          <Content />
        </div>
      </main>
    </div>
  </article>
</Layout>